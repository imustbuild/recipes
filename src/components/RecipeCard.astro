---
import type { NormalizedRecipe } from '@/types/recipe';
import { formatDuration } from '@/lib/normalize';
import Tag from './Tag.astro';

interface Props {
  recipe: NormalizedRecipe;
  featured?: boolean;
}

const { recipe, featured = false } = Astro.props;
const totalTime = formatDuration(recipe.times.total_minutes);
---

<article class:list={[
  'group bg-white rounded-2xl border border-stone-200 overflow-hidden transition-all duration-300',
  'hover:shadow-lg hover:shadow-stone-200/50 hover:border-stone-300',
  featured ? 'sm:flex' : ''
]}>
  <div class:list={[
    'p-6',
    featured ? 'sm:flex-1' : ''
  ]}>
    <div class="flex items-start justify-between gap-4 mb-3">
      <h3 class:list={[
        'font-display font-semibold text-stone-900 group-hover:text-terracotta-600 transition-colors',
        featured ? 'text-2xl' : 'text-lg'
      ]}>
        <a href={`/recipes/${recipe.slug}`} class="hover:underline decoration-terracotta-300 underline-offset-2">
          {recipe.title}
        </a>
      </h3>
      {totalTime && (
        <span class="flex-shrink-0 text-sm text-stone-500 bg-stone-100 px-2 py-1 rounded-md">
          {totalTime}
        </span>
      )}
    </div>
    
    {recipe.description && (
      <p class:list={[
        'text-stone-600 mb-4',
        featured ? 'text-base' : 'text-sm line-clamp-2'
      ]}>
        {recipe.description}
      </p>
    )}
    
    {recipe.tags.length > 0 && (
      <div class="flex flex-wrap gap-1.5">
        {recipe.tags.slice(0, featured ? 6 : 4).map(tag => (
          <Tag tag={tag} size="sm" />
        ))}
        {recipe.tags.length > (featured ? 6 : 4) && (
          <span class="text-xs text-stone-400 self-center">
            +{recipe.tags.length - (featured ? 6 : 4)} more
          </span>
        )}
      </div>
    )}
  </div>
</article>

