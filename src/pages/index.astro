---
import Layout from '@layouts/Layout.astro';
import Header from '@components/Header.astro';
import Footer from '@components/Footer.astro';
import RecipeCard from '@components/RecipeCard.astro';
import SearchBox from '@components/SearchBox.astro';
import Tag from '@components/Tag.astro';
import { loadAllRecipes, getFeaturedRecipes, getTagsIndex } from '@lib/recipes';

const recipes = loadAllRecipes();
const featured = getFeaturedRecipes(recipes, 1);
const recent = recipes.slice(1, 5);
const tagsIndex = getTagsIndex(recipes);
const topTags = tagsIndex.tags.slice(0, 8);
---

<Layout title="Recipes ¬∑ A Personal Collection">
  <div class="min-h-screen flex flex-col">
    <Header currentPath="/" />
    
    <main class="flex-1">
      <!-- Hero -->
      <section class="relative overflow-hidden bg-gradient-to-br from-cream-50 via-white to-cream-100 border-b border-stone-200">
        <div class="absolute inset-0 bg-[radial-gradient(circle_at_30%_20%,rgba(184,98,58,0.06),transparent_50%)]"></div>
        <div class="absolute inset-0 bg-[radial-gradient(circle_at_70%_80%,rgba(86,122,71,0.06),transparent_50%)]"></div>
        
        <div class="relative max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-16 sm:py-24">
          <h1 class="font-display text-4xl sm:text-5xl lg:text-6xl font-semibold text-stone-900 mb-4">
            Good food,<br />
            <span class="text-terracotta-600">simple recipes</span>
          </h1>
          <p class="text-lg sm:text-xl text-stone-600 max-w-xl mb-8">
            A personal collection of tried-and-true recipes. No life stories, no ads ‚Äî just the good stuff.
          </p>
          
          <div class="max-w-md">
            <SearchBox placeholder="What do you want to cook?" />
          </div>
          
          {topTags.length > 0 && (
            <div class="mt-6 flex flex-wrap gap-2">
              <span class="text-sm text-stone-500 self-center mr-1">Popular:</span>
              {topTags.map(({ tag }) => (
                <Tag tag={tag} size="sm" />
              ))}
            </div>
          )}
        </div>
      </section>
      
      <!-- Featured -->
      {featured.length > 0 && (
        <section class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
          <h2 class="font-display text-2xl font-semibold text-stone-900 mb-6">Featured</h2>
          <div class="grid gap-6">
            {featured.map(recipe => (
              <RecipeCard recipe={recipe} featured />
            ))}
          </div>
        </section>
      )}
      
      <!-- Recent Recipes -->
      {recent.length > 0 && (
        <section class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-12 border-t border-stone-100">
          <div class="flex items-center justify-between mb-6">
            <h2 class="font-display text-2xl font-semibold text-stone-900">Recent Recipes</h2>
            <a href="/recipes" class="text-sm font-medium text-terracotta-600 hover:text-terracotta-700 transition-colors">
              View all ‚Üí
            </a>
          </div>
          <div class="grid sm:grid-cols-2 gap-6">
            {recent.map(recipe => (
              <RecipeCard recipe={recipe} />
            ))}
          </div>
        </section>
      )}
      
      <!-- Empty State -->
      {recipes.length === 0 && (
        <section class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-24 text-center">
          <div class="text-6xl mb-4">üç≥</div>
          <h2 class="font-display text-2xl font-semibold text-stone-900 mb-2">No recipes yet</h2>
          <p class="text-stone-600 mb-6">Time to add your first recipe!</p>
          <a href="/admin/new" class="inline-flex items-center gap-2 bg-terracotta-600 text-white px-5 py-2.5 rounded-lg font-medium hover:bg-terracotta-700 transition-colors">
            Add Recipe
          </a>
        </section>
      )}
    </main>
    
    <Footer />
  </div>
</Layout>
